# 推广到其他生成模型

如果要替换成其他生成模型，推导过程类似：
## 1. 选择基础生成模型

例如：朴素贝叶斯、混合专家模型等。设模型参数为 $\theta$。

## 2. 写出完整的概率模型

- 有标记数据：$p(x, y | \theta) = p(y | \theta) \cdot p(x | y, \theta)$

- 未标记数据：$p(x | \theta) = \sum_y p(y | \theta) \cdot p(x | y, \theta)$
## 3. 构造对数似然
$$

LL(D_l \cup D_u) = \sum_{(x_j, y_j) \in D_l} \ln p(x_j, y_j | \theta) + \sum_{x_j \in D_u} \ln\left( \sum_y p(x_j, y | \theta) \right)

$$
## 4. 设计EM算法

- **E步**：对未标记数据，计算隐变量（类别）的后验概率

$$

\gamma_{jy} = \frac{p(y | \theta) \cdot p(x_j | y, \theta)}{\sum_{y'} p(y' | \theta) \cdot p(x_j | y', \theta)}

$$

- **M步**：基于完整数据（有标记数据+软分配）更新参数

## 5. 示例：朴素贝叶斯模型

对于离散特征，设：

- 类别先验：$\pi_y = p(y)$

- 特征条件概率：$\theta_{y,v}^{(k)} = p(x^{(k)} = v | y)$

则：

- E步：计算未标记样本属于各类的概率

- M步：

$$

\pi_y = \frac{\sum_{j=1}^l I(y_j = y) + \sum_{j=l+1}^{l+u} \gamma_{jy}}{m}

$$

$$

\theta_{y,v}^{(k)} = \frac{\sum_{j=1}^l I(y_j = y, x_j^{(k)} = v) + \sum_{j=l+1}^{l+u} \gamma_{jy} \cdot I(x_j^{(k)} = v)}{\sum_{j=1}^l I(y_j = y) + \sum_{j=l+1}^{l+u} \gamma_{jy}}

$$